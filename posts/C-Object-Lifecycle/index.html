<!DOCTYPE html><html lang="en" data-theme="dark"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1,viewport-fit=cover"><title>C++ Object Lifecycle | TONY'S STUDIO</title><meta name="author" content="Tony Lewis"><meta name="copyright" content="Tony Lewis"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#300303"><meta name="description" content="Breakdown of C++ object lifecycle to wipe out all your doubts"><meta property="og:type" content="article"><meta property="og:title" content="C++ Object Lifecycle"><meta property="og:url" content="https://blog.tonys-studio.top/posts/C-Object-Lifecycle/"><meta property="og:site_name" content="TONY&#39;S STUDIO"><meta property="og:description" content="Breakdown of C++ object lifecycle to wipe out all your doubts"><meta property="og:locale" content="en_US"><meta property="og:image" content="https://tonys-studio-1308383348.cos.ap-beijing.myqcloud.com/blog/static/cover/mando/24/04.jpeg"><meta property="article:published_time" content="2024-10-01T09:07:53.000Z"><meta property="article:modified_time" content="2025-10-17T15:01:32.608Z"><meta property="article:author" content="Tony Lewis"><meta property="article:tag" content="C&#x2F;C++"><meta name="twitter:card" content="summary"><meta name="twitter:image" content="https://tonys-studio-1308383348.cos.ap-beijing.myqcloud.com/blog/static/cover/mando/24/04.jpeg"><script type="application/ld+json">{
  "@context": "https://schema.org",
  "@type": "BlogPosting",
  "headline": "C++ Object Lifecycle",
  "url": "https://blog.tonys-studio.top/posts/C-Object-Lifecycle/",
  "image": "https://tonys-studio-1308383348.cos.ap-beijing.myqcloud.com/blog/static/cover/mando/24/04.jpeg",
  "datePublished": "2024-10-01T09:07:53.000Z",
  "dateModified": "2025-10-17T15:01:32.608Z",
  "author": [
    {
      "@type": "Person",
      "name": "Tony Lewis",
      "url": "https://www.tonys-studio.top"
    }
  ]
}</script><link rel="shortcut icon" href="https://tonys-studio-1308383348.cos.ap-beijing.myqcloud.com/blog/static/favicon.svg"><link rel="canonical" href="https://blog.tonys-studio.top/posts/C-Object-Lifecycle/"><link rel="preconnect" href="//cdn.jsdelivr.net"><link rel="preconnect" href="//hm.baidu.com"><link rel="preconnect" href="//www.clarity.ms"><meta name="baidu-site-verification" content="codeva-R6O16YoeQt"><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free/css/all.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/node-snackbar/dist/snackbar.min.css" media="print" onload='this.media="all"'><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fancyapps/ui/dist/fancybox/fancybox.min.css" media="print" onload='this.media="all"'><script>(()=>{const t={set:(e,t,o)=>{if(!o)return;const a=Date.now()+864e5*o;localStorage.setItem(e,JSON.stringify({value:t,expiry:a}))},get:e=>{const t=localStorage.getItem(e);if(!t)return;const{value:o,expiry:a}=JSON.parse(t);if(!(Date.now()>a))return o;localStorage.removeItem(e)}};window.btf={saveToLocal:t,getScript:(e,t={})=>new Promise((o,a)=>{const n=document.createElement("script");n.src=e,n.async=!0,Object.entries(t).forEach(([e,t])=>n.setAttribute(e,t)),n.onload=n.onreadystatechange=()=>{n.readyState&&!/loaded|complete/.test(n.readyState)||o()},n.onerror=a,document.head.appendChild(n)}),getCSS:(e,t)=>new Promise((o,a)=>{const n=document.createElement("link");n.rel="stylesheet",n.href=e,t&&(n.id=t),n.onload=n.onreadystatechange=()=>{n.readyState&&!/loaded|complete/.test(n.readyState)||o()},n.onerror=a,document.head.appendChild(n)}),addGlobalFn:(e,t,o=!1,a=window)=>{if(e.startsWith("pjax"))return;const n=a.globalFn||{};n[e]=n[e]||{},n[e][o||Object.keys(n[e]).length]=t,a.globalFn=n}};const o=()=>{document.documentElement.setAttribute("data-theme","dark"),null!==document.querySelector('meta[name="theme-color"]')&&document.querySelector('meta[name="theme-color"]').setAttribute("content","#300303")},a=()=>{document.documentElement.setAttribute("data-theme","light"),null!==document.querySelector('meta[name="theme-color"]')&&document.querySelector('meta[name="theme-color"]').setAttribute("content","undefined")};btf.activateDarkMode=o,btf.activateLightMode=a;const n=t.get("theme"),r=window.matchMedia("(prefers-color-scheme: dark)"),c=window.matchMedia("(prefers-color-scheme: light)");if(void 0===n){if(c.matches)a();else if(r.matches)o();else{const e=(new Date).getHours();e<=6||e>=18?o():a()}r.addEventListener("change",()=>{void 0===t.get("theme")&&(e.matches?o():a())})}else"light"===n?a():o();const d=t.get("aside-status");void 0!==d&&document.documentElement.classList.toggle("hide-aside","hide"===d);/iPad|iPhone|iPod|Macintosh/.test(navigator.userAgent)&&document.documentElement.classList.add("apple")})()</script><script>var _hmt=_hmt||[];!function(){var t=document.createElement("script");t.src="https://hm.baidu.com/hm.js?68629f5da0a0c3347b896920fbf164b5";var a=document.getElementsByTagName("script")[0];a.parentNode.insertBefore(t,a)}(),btf.addGlobalFn("pjaxComplete",()=>{_hmt.push(["_trackPageview",window.location.pathname])},"baidu_analytics")</script><script>!function(t,e,n,c,r,s,a){t[n]=t[n]||function(){(t[n].q=t[n].q||[]).push(arguments)},(s=e.createElement(c)).async=1,s.src="https://www.clarity.ms/tag/sthrplbt7c",(a=e.getElementsByTagName(c)[0]).parentNode.insertBefore(s,a)}(window,document,"clarity","script")</script><script>const GLOBAL_CONFIG={root:"/",algolia:void 0,localSearch:{path:"/search.xml",preload:!1,top_n_per_article:3,unescape:!1,pagination:{enable:!0,hitsPerPage:8},languages:{hits_empty:"No results found for: ${query}",hits_stats:"${hits} articles found"}},translate:void 0,highlight:{plugin:"highlight.js",highlightCopy:!0,highlightLang:!0,highlightHeightLimit:300,highlightFullpage:!1,highlightMacStyle:!1},copy:{success:"Copy Successful",error:"Copy Failed",noSupport:"Browser Not Supported"},relativeDate:{homepage:!1,post:!1},runtime:"days",dateSuffix:{just:"Just now",min:"minutes ago",hour:"hours ago",day:"days ago",month:"months ago"},copyright:{limitCount:256,languages:{author:"Author: Tony Lewis",link:"Link: ",source:"Source: TONY'S STUDIO",info:"Copyright belongs to the author. For commercial use, please contact the author for authorization. For non-commercial use, please indicate the source."}},lightbox:"fancybox",Snackbar:{chs_to_cht:"You have switched to Traditional Chinese",cht_to_chs:"You have switched to Simplified Chinese",day_to_night:"You have switched to Dark Mode",night_to_day:"You have switched to Light Mode",bgLight:"#871798",bgDark:"#C81025",position:"bottom-left"},infinitegrid:{js:"https://cdn.jsdelivr.net/npm/@egjs/infinitegrid/dist/infinitegrid.min.js",buttonText:"Load More"},isPhotoFigcaption:!1,islazyloadPlugin:!1,isAnchor:!1,percent:{toc:!0,rightside:!0},autoDarkmode:!0}</script><script id="config-diff">var GLOBAL_CONFIG_SITE={title:"C++ Object Lifecycle",isHighlightShrink:!1,isToc:!0,pageType:"post"}</script><link rel="stylesheet" href="/static/custom.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/hexo-butterfly-footer-beautify@1.0.6/lib/runtime.min.css" media="print" onload='this.media="all"'><meta name="generator" content="Hexo 7.3.0"></head><body><script>window.paceOptions={restartOnPushState:!1},btf.addGlobalFn("pjaxSend",()=>{Pace.restart()},"pace_restart")</script><link rel="stylesheet" href="/static/barber-shop.css"><script src="https://cdn.jsdelivr.net/npm/pace-js/pace.min.js"></script><div id="web_bg" style="background-image:url(https://tonys-studio-1308383348.cos.ap-beijing.myqcloud.com/blog/static/background.png)"></div><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="avatar-img text-center"><img src="https://tonys-studio-1308383348.cos.ap-beijing.myqcloud.com/blog/static/avatar.png" onerror='this.onerror=null,this.src="https://tonys-studio-1308383348.cos.ap-beijing.myqcloud.com/blog/static/missing.gif"' alt="avatar"></div><div class="site-data text-center"><a href="/archives/"><div class="headline">Articles</div><div class="length-num">95</div></a><a href="/tags/"><div class="headline">Tags</div><div class="length-num">86</div></a><a href="/categories/"><div class="headline">Categories</div><div class="length-num">40</div></a></div><div class="menus_items"><div class="menus_item"><span class="site-page group"><i class="fa-fw fas fa-newspaper"></i><span> Posts</span><i class="fas fa-chevron-down"></i></span><ul class="menus_item_child"><li><a class="site-page child" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> Archives</span></a></li><li><a class="site-page child" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> Categories</span></a></li><li><a class="site-page child" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> Tags</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="/gallery/"><i class="fa-fw fas fa-images"></i><span> Gallery</span></a></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fas fa-link"></i><span> Links</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-jedi fa-beat"></i><span> About</span></a></div></div></div></div><div class="post" id="body-wrap"><header class="post-bg" id="page-header" style="background-image:url(https://tonys-studio-1308383348.cos.ap-beijing.myqcloud.com/blog/static/cover/mando/24/04.jpeg)"><nav id="nav"><span id="blog-info"><a class="nav-site-title" href="/"><img class="site-icon" src="https://tonys-studio-1308383348.cos.ap-beijing.myqcloud.com/blog/static/logo.svg" alt="Logo"><span class="site-name">TONY'S STUDIO</span></a><a class="nav-page-title" href="/"><span class="site-name">C++ Object Lifecycle</span><span class="site-name"><i class="fa-solid fa-circle-arrow-left"></i><span> Back to Home</span></span></a></span><div id="menus"><div id="search-button"><span class="site-page social-icon search"><i class="fas fa-search fa-fw"></i><span> Search</span></span></div><div class="menus_items"><div class="menus_item"><span class="site-page group"><i class="fa-fw fas fa-newspaper"></i><span> Posts</span><i class="fas fa-chevron-down"></i></span><ul class="menus_item_child"><li><a class="site-page child" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> Archives</span></a></li><li><a class="site-page child" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> Categories</span></a></li><li><a class="site-page child" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> Tags</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="/gallery/"><i class="fa-fw fas fa-images"></i><span> Gallery</span></a></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fas fa-link"></i><span> Links</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-jedi fa-beat"></i><span> About</span></a></div></div><div id="toggle-menu"><span class="site-page"><i class="fas fa-bars fa-fw"></i></span></div></div></nav><div id="post-info"><h1 class="post-title">C++ Object Lifecycle</h1><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="far fa-calendar-alt fa-fw post-meta-icon"></i><span class="post-meta-label">Created</span><time class="post-meta-date-created" datetime="2024-10-01T09:07:53.000Z" title="Created Oct. 1st, 2024 - 17:07:53 17:07:53">Oct. 1st, 2024 - 17:07:53</time><span class="post-meta-separator">|</span><i class="fas fa-history fa-fw post-meta-icon"></i><span class="post-meta-label">Updated</span><time class="post-meta-date-updated" datetime="2025-10-17T15:01:32.608Z" title="Updated Oct. 17th, 2025 - 23:01:32 23:01:32">Oct. 17th, 2025 - 23:01:32</time></span><span class="post-meta-categories"><span class="post-meta-separator">|</span><i class="fas fa-inbox fa-fw post-meta-icon"></i><a class="post-meta-categories" href="/categories/Programming-Languages/">Programming Languages</a><i class="fas fa-angle-right post-meta-separator"></i><i class="fas fa-inbox fa-fw post-meta-icon"></i><a class="post-meta-categories" href="/categories/Programming-Languages/C-C/">C/C++</a></span></div><div class="meta-secondline"><span class="post-meta-separator">|</span><span class="post-meta-wordcount"><i class="far fa-file-word fa-fw post-meta-icon"></i><span class="post-meta-label">Word Count:</span><span class="word-count">3.1k</span><span class="post-meta-separator">|</span><i class="far fa-clock fa-fw post-meta-icon"></i><span class="post-meta-label">Reading Time:</span><span>19mins</span></span><span class="post-meta-separator">|</span><span data-flag-title=""><i class="far fa-eye fa-fw post-meta-icon"></i><span class="post-meta-label">Post Views:</span><span class="waline-pageview-count" data-path="/posts/C-Object-Lifecycle/"><i class="fa-solid fa-spinner fa-spin"></i></span></span><span class="post-meta-separator">|</span><span class="post-meta-commentcount"><i class="far fa-comments fa-fw post-meta-icon"></i><span class="post-meta-label">Comments:</span><a href="/posts/C-Object-Lifecycle/#post-comment"><span class="waline-comment-count" data-path="/posts/C-Object-Lifecycle/"><i class="fa-solid fa-spinner fa-spin"></i></span></a></span></div></div></div></header><main class="layout" id="content-inner"><div id="post"><article class="container post-content" id="article-container"><p style="text-align:center"><i>&ldquo;I need to see,</i><br><i>the truth other men cannot see,</i><br><i>to be things that others can't be!</i><br><i>Give me courage to go where no angel will go!</i><br><i>And I will go!</i><br><i>I need to know!&rdquo;</i></p><p style="text-align:right"><i>&mdash; Jekyll &amp; Hyde</i></p><h1 id="Prologue"><a href="#Prologue" class="headerlink" title="Prologue"></a>Prologue</h1><p>As a C++ developer, or have some experience in C++, did you ever stop coding, staring at the monitor, deciding which parameter to use. To be specific, is pass by value, const reference or r-value.</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="type">void</span> <span class="title">Func</span><span class="params">(Object obj)</span></span>;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">Func</span><span class="params">(<span class="type">const</span> Object&amp; obj)</span></span>;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">Func</span><span class="params">(Object&amp;&amp; obj)</span></span>;</span><br></pre></td></tr></table></figure><p>I know why you stop at this, because you worries about the constructor overhead. That‚Äôs good, but don‚Äôt waste time on this every time.</p><p>So in this article, I‚Äôll break down the constructor&#x2F;destructor call for each of these types of parameters, thus you can confidently choose the best combination for your code.</p><hr><h1 id="Instrument-Utilities"><a href="#Instrument-Utilities" class="headerlink" title="Instrument Utilities"></a>Instrument Utilities</h1><h2 id="Subject-class"><a href="#Subject-class" class="headerlink" title="Subject class"></a>Subject class</h2><p>Before we start, we have to think of a way to visualize the object‚Äôs lifecycle. This is simple, just put an output statement in each of these functions. So here is our <code>Object</code> class.</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">Object</span></span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="built_in">Object</span>() : _data(<span class="number">0</span>) &#123; cout &lt;&lt; <span class="string">&quot;Default constructor       (&quot;</span> &lt;&lt; <span class="keyword">this</span> &lt;&lt; <span class="string">&quot;)&quot;</span> &lt;&lt; endl; &#125;</span><br><span class="line"></span><br><span class="line">    <span class="built_in">Object</span>(<span class="type">int</span> data) : _data(data)</span><br><span class="line">    &#123;</span><br><span class="line">        cout &lt;&lt; <span class="string">&quot;Parameterized constructor (&quot;</span> &lt;&lt; <span class="keyword">this</span> &lt;&lt; <span class="string">&quot;)&quot;</span> &lt;&lt; endl;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="built_in">Object</span>(<span class="type">const</span> Object&amp; other)</span><br><span class="line">    &#123;</span><br><span class="line">        cout &lt;&lt; <span class="string">&quot;Copy constructor          (&quot;</span> &lt;&lt; <span class="keyword">this</span> &lt;&lt; <span class="string">&quot;)&quot;</span> &lt;&lt; endl;</span><br><span class="line">        _data = other._data;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="built_in">Object</span>(Object&amp;&amp; other) <span class="keyword">noexcept</span></span><br><span class="line">    &#123;</span><br><span class="line">        cout &lt;&lt; <span class="string">&quot;Move constructor          (&quot;</span> &lt;&lt; <span class="keyword">this</span> &lt;&lt; <span class="string">&quot;)&quot;</span> &lt;&lt; endl;</span><br><span class="line">        _data = other._data;</span><br><span class="line">        other._data = <span class="number">-1</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    Object&amp; <span class="keyword">operator</span>=(<span class="type">const</span> Object&amp; other)</span><br><span class="line">    &#123;</span><br><span class="line">        cout &lt;&lt; <span class="string">&quot;Copy assignment operator  (&quot;</span> &lt;&lt; <span class="keyword">this</span> &lt;&lt; <span class="string">&quot;)&quot;</span> &lt;&lt; endl;</span><br><span class="line">        <span class="keyword">if</span> (<span class="keyword">this</span> != &amp;other)</span><br><span class="line">        &#123;</span><br><span class="line">            _data = other._data;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> *<span class="keyword">this</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    Object&amp; <span class="keyword">operator</span>=(Object&amp;&amp; other) <span class="keyword">noexcept</span></span><br><span class="line">    &#123;</span><br><span class="line">        cout &lt;&lt; <span class="string">&quot;Move assignment operator  (&quot;</span> &lt;&lt; <span class="keyword">this</span> &lt;&lt; <span class="string">&quot;)&quot;</span> &lt;&lt; endl;</span><br><span class="line">        <span class="keyword">if</span> (<span class="keyword">this</span> != &amp;other)</span><br><span class="line">        &#123;</span><br><span class="line">            _data = other._data;</span><br><span class="line">            other._data = <span class="number">-1</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> *<span class="keyword">this</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    ~<span class="built_in">Object</span>()</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">if</span> (_data != <span class="number">-1</span>)</span><br><span class="line">        &#123;</span><br><span class="line">            cout &lt;&lt; <span class="string">&quot;Destructor                (&quot;</span> &lt;&lt; <span class="keyword">this</span> &lt;&lt; <span class="string">&quot;)&quot;</span> &lt;&lt; endl;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span></span><br><span class="line">        &#123;</span><br><span class="line">            cout &lt;&lt; <span class="string">&quot;Destructor (moved)        (&quot;</span> &lt;&lt; <span class="keyword">this</span> &lt;&lt; <span class="string">&quot;)&quot;</span> &lt;&lt; endl;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="type">void</span> <span class="title">Print</span><span class="params">()</span> <span class="type">const</span> </span>&#123; cout &lt;&lt; <span class="string">&quot;Data: &quot;</span> &lt;&lt; _data &lt;&lt; endl; &#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">private</span>:</span><br><span class="line">    <span class="type">int</span> _data;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><p>We also add a <code>_data</code> field for parameterized constructor. And to mimic real move constructor and operator, we use <code>-1</code> to represent a ‚Äúmoved‚Äù object, which shouldn‚Äôt be used anymore.</p><h2 id="Scope-indicator"><a href="#Scope-indicator" class="headerlink" title="Scope indicator"></a>Scope indicator</h2><p>The basic knowledge you should know is that in C++, object lives in the current scope, and is guaranteed to be destroyed reaches the end of the scope. So we can use this as a trick to display the span of a scope.</p><div class="note info flat"><p>I first learnt this trick from Scott Mayer‚Äôs <em>Effective C++</em>, where he mentioned a way to measure the execution time of a scope.</p></div><p>So here it is, I call it <code>Fence</code>. To tell scope and function call apart, I used a <code>scope</code> flag, thus it may look a little bit verbose.</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">Fence</span></span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="built_in">Fence</span>(<span class="type">bool</span> scope, <span class="type">const</span> <span class="type">char</span>* message) : _scope(scope)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">if</span> (_scope)</span><br><span class="line">        &#123;</span><br><span class="line">            cout &lt;&lt; <span class="string">&quot;========== &quot;</span> &lt;&lt; message &lt;&lt; endl;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span></span><br><span class="line">        &#123;</span><br><span class="line">            cout &lt;&lt; <span class="string">&quot;&gt;&gt;&gt;&gt;&gt; &quot;</span> &lt;&lt; message &lt;&lt; endl;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    ~<span class="built_in">Fence</span>()</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">if</span> (_scope)</span><br><span class="line">        &#123;</span><br><span class="line">            cout &lt;&lt; <span class="string">&quot;----------&quot;</span> &lt;&lt; endl &lt;&lt; endl;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span></span><br><span class="line">        &#123;</span><br><span class="line">            cout &lt;&lt; <span class="string">&quot;&lt;&lt;&lt;&lt;&lt;&quot;</span> &lt;&lt; endl;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">private</span>:</span><br><span class="line">    <span class="type">bool</span> _scope;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><p>Then, to simplify the use of this class, we can use macro to wrap this. To indicate scope, we can use the following macro.</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">define</span> BEGIN_SCOPE(message) do &#123; Fence __scope_fence(true, message)</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> END_SCOPE()          &#125; while (0)</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="built_in">BEGIN_SCOPE</span>(<span class="string">&quot;A&quot;</span>);</span><br><span class="line">    <span class="comment">// some code</span></span><br><span class="line">    <span class="built_in">END_SCOPE</span>();</span><br><span class="line">    </span><br><span class="line">    <span class="built_in">BEGIN_SCOPE</span>(<span class="string">&quot;B&quot;</span>);</span><br><span class="line">    <span class="comment">// some other code</span></span><br><span class="line">    <span class="built_in">END_SCOPE</span>();</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// other code</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>To indicate function, we could also use a compiler macro to avoid writing function name twice. And since we record the complete function, so we don‚Äôt need to introduce a nested scope.</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">define</span> _BEGIN_CALL(func)    Fence __call_fence(false, func)</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> BEGIN_CALL()         _BEGIN_CALL(__func__)</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">Func</span><span class="params">(<span class="comment">/* some parameters */</span>)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="built_in">BEGIN_CALL</span>();</span><br><span class="line">    <span class="comment">// some code</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>Beside, here is another macro to add blank line to the output.</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">define</span> BR()                 std::cout &lt;&lt; std::endl</span></span><br></pre></td></tr></table></figure><hr><h1 id="Lifecycle-Breakdown"><a href="#Lifecycle-Breakdown" class="headerlink" title="Lifecycle Breakdown"></a>Lifecycle Breakdown</h1><div class="note info flat"><p>I write no comment in code, so that you can think about the result first. ü§î And all experiments are done with MSVC in Visual Studio 2022. Both Debug and Release profiles output the same.</p></div><h2 id="Object-creation"><a href="#Object-creation" class="headerlink" title="Object creation"></a>Object creation</h2><p>First, let‚Äôs see how C++ handle object creation. We create these objects to see all possible constructor and operators.</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">BEGIN_SCOPE</span>(<span class="string">&quot;Create&quot;</span>);</span><br><span class="line">    <span class="function">Object <span class="title">obj</span><span class="params">(<span class="number">10</span>)</span></span>;</span><br><span class="line">    Object obj2 = <span class="built_in">Object</span>(<span class="number">15</span>);</span><br><span class="line">    <span class="function">Object <span class="title">obj3</span><span class="params">(obj2)</span></span>;</span><br><span class="line">    <span class="function">Object <span class="title">obj4</span><span class="params">(std::move(obj3))</span></span>;</span><br><span class="line">    obj = obj2;</span><br><span class="line">    obj = <span class="built_in">Object</span>(<span class="number">25</span>);</span><br><span class="line">    obj = std::<span class="built_in">move</span>(obj2);</span><br><span class="line"><span class="built_in">END_SCOPE</span>();</span><br></pre></td></tr></table></figure><p>Running this, we‚Äôll have the following output.</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">========== Create</span><br><span class="line">Parameterized constructor (0000009D83FDF004)</span><br><span class="line">Parameterized constructor (0000009D83FDF024)</span><br><span class="line">Copy constructor          (0000009D83FDF044)</span><br><span class="line">Move constructor          (0000009D83FDF064)</span><br><span class="line">Copy assignment operator  (0000009D83FDF004)</span><br><span class="line">Parameterized constructor (0000009D83FDF4E4)</span><br><span class="line">Move assignment operator  (0000009D83FDF004)</span><br><span class="line">Destructor (moved)        (0000009D83FDF4E4)</span><br><span class="line">Move assignment operator  (0000009D83FDF004)</span><br><span class="line">Destructor                (0000009D83FDF064)</span><br><span class="line">Destructor (moved)        (0000009D83FDF044)</span><br><span class="line">Destructor (moved)        (0000009D83FDF024)</span><br><span class="line">Destructor                (0000009D83FDF004)</span><br><span class="line">----------</span><br></pre></td></tr></table></figure><p>It‚Äôs a bit long, so I‚Äôll break it down one by one.</p><p>First, no doubt that <code>Object obj(10);</code> calls the parameterized constructor. Then, for <code>Object obj2 = Object(15);</code>, <code>=</code> will also invoke the constructor instead of the operator because it is considered to be variable definition. Following <code>Object obj3(obj2);</code> and <code>Object obj4(std::move(obj3));</code> obviously calls copy and move constructor.</p><div class="note warning success flat"><p>Constructor can be taken as a special function call, and soon I‚Äôll talk about parameter passing in functions.</p></div><p>Then, for regular assignment statement, we‚Äôll call the corresponding operator. And here comes the overhead. If you assign a temporary value to a variable, e.g. <code>obj = Object(25)</code>, an extra object will be created with move operator invoked. At last, variable or moved one to variable only invokes copy and move operator as we expected.</p><p>So for this part, we can conclude that, only a temporary value assignment will cause a little overhead. Although temporary value in initialization can be optimized, compiler doesn‚Äôt seem to care about that in assignment. I think that‚Äôs what temporary value meant to be. However, it invokes the move assignment, so it has little impact if you have a good ‚Äúmove‚Äù.</p><h2 id="Return-Value-Optimization"><a href="#Return-Value-Optimization" class="headerlink" title="Return Value Optimization"></a>Return Value Optimization</h2><p>There is a special case in object creation, which is called return value optimization (RVO). It eliminates the redundant copy for named or temporary objects when it plays as the return value. And that means, it will create the object directly at the caller‚Äôs scope. For example, we have the following function that returns an object.</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="function">Object <span class="title">CreateA</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="built_in">BEGIN_CALL</span>();      <span class="comment">// equivalent to </span></span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">Object</span>(<span class="number">10</span>); <span class="comment">// return &#123; 10 &#125;;</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function">Object <span class="title">CreateB</span><span class="params">(<span class="type">int</span> option)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="built_in">BEGIN_CALL</span>();</span><br><span class="line">    <span class="function">Object <span class="title">obj</span><span class="params">(<span class="number">10</span>)</span></span>;</span><br><span class="line">    <span class="function">Object <span class="title">obj2</span><span class="params">(<span class="number">20</span>)</span></span>;</span><br><span class="line">    <span class="keyword">if</span> (option == <span class="number">0</span>)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">return</span> obj;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">return</span> obj2;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>And we can write the test.</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">BEGIN_SCOPE</span>(<span class="string">&quot;Return Value Optimization&quot;</span>);</span><br><span class="line">    Object obj = <span class="built_in">CreateA</span>();</span><br><span class="line">    obj = <span class="built_in">CreateA</span>();</span><br><span class="line">    Object obj2 = <span class="built_in">CreateB</span>(<span class="number">1</span>);</span><br><span class="line">    obj = <span class="built_in">CreateB</span>(<span class="number">0</span>);</span><br><span class="line">    <span class="built_in">CreateA</span>();</span><br><span class="line"><span class="built_in">END_SCOPE</span>();</span><br></pre></td></tr></table></figure><p>The output is as follows.</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line">========== Return Value Optimization</span><br><span class="line">&gt;&gt;&gt;&gt;&gt; CreateA</span><br><span class="line">Parameterized constructor (000000781551F284)</span><br><span class="line">&lt;&lt;&lt;&lt;&lt;</span><br><span class="line">&gt;&gt;&gt;&gt;&gt; CreateA</span><br><span class="line">Parameterized constructor (000000781551F704)</span><br><span class="line">&lt;&lt;&lt;&lt;&lt;</span><br><span class="line">Move assignment operator  (000000781551F284)</span><br><span class="line">Destructor (moved)        (000000781551F704)</span><br><span class="line">&gt;&gt;&gt;&gt;&gt; CreateB</span><br><span class="line">Parameterized constructor (000000781551F064)</span><br><span class="line">Parameterized constructor (000000781551F084)</span><br><span class="line">Move constructor          (000000781551F2A4)</span><br><span class="line">Destructor (moved)        (000000781551F084)</span><br><span class="line">Destructor                (000000781551F064)</span><br><span class="line">&lt;&lt;&lt;&lt;&lt;</span><br><span class="line">&gt;&gt;&gt;&gt;&gt; CreateB</span><br><span class="line">Parameterized constructor (000000781551F064)</span><br><span class="line">Parameterized constructor (000000781551F084)</span><br><span class="line">Move constructor          (000000781551F724)</span><br><span class="line">Destructor                (000000781551F084)</span><br><span class="line">Destructor (moved)        (000000781551F064)</span><br><span class="line">&lt;&lt;&lt;&lt;&lt;</span><br><span class="line">Move assignment operator  (000000781551F284)</span><br><span class="line">Destructor (moved)        (000000781551F724)</span><br><span class="line">&gt;&gt;&gt;&gt;&gt; CreateA</span><br><span class="line">Parameterized constructor (000000781551F744)</span><br><span class="line">&lt;&lt;&lt;&lt;&lt;</span><br><span class="line">Destructor                (000000781551F744)</span><br><span class="line">Destructor                (000000781551F2A4)</span><br><span class="line">Destructor                (000000781551F284)</span><br><span class="line">----------</span><br></pre></td></tr></table></figure><p>The best situation for RVO is when the returned object is unique, which is our <code>CreateA</code> here. We can see that there is literally no extra constructor invoked for <code>Object obj = CreateA();</code>, and <code>obj = CreateA();</code> only calls the move operator. This is what we wish for.</p><p>However, our program may get more complex. For <code>CreateB</code>, there are two choices for return, so we cannot perfectly apply RVO, but we can still optimize it to use a move constructor only to initialize it in the caller. However, we can make it better by placing <code>obj</code> and <code>obj2</code> in their corresponding <code>if</code>-<code>else</code> scope, so that perfect RVO can be applied.</p><p>One thing to notice is that, when RVO applied, the object is constructed in callee, and destructed in caller.</p><div class="note info flat"><p>The condition for perfect RVO is that (I guess), the declaration of each return value does not <strong>dominate</strong> return statements that return other value. So that there will be no conflict in deciding their location in caller‚Äôs scope.</p><p>What is <strong>dominate</strong> then? To put it simple, if A dominates B, then every execution path to B must pass A first.</p></div><p>If a meticulous reader, you are, then you may ask, why use this verbose <code>if</code>-<code>else</code> instead of a ternary operator? Good question. We can test that.</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="function">Object <span class="title">CreateB</span><span class="params">(<span class="type">int</span> option)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="built_in">BEGIN_CALL</span>();</span><br><span class="line">    <span class="function">Object <span class="title">obj</span><span class="params">(<span class="number">10</span>)</span></span>;</span><br><span class="line">    <span class="function">Object <span class="title">obj2</span><span class="params">(<span class="number">20</span>)</span></span>;</span><br><span class="line">    <span class="keyword">return</span> option ? obj : obj2;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>Surprisingly (or not if you just know that), it results in a copy constructor instead of move!</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">&gt;&gt;&gt;&gt;&gt; CreateB</span><br><span class="line">Parameterized constructor (00000036E174F364)</span><br><span class="line">Parameterized constructor (00000036E174F384)</span><br><span class="line">Copy constructor          (00000036E174F5C4)</span><br><span class="line">Destructor                (00000036E174F384)</span><br><span class="line">Destructor                (00000036E174F364)</span><br><span class="line">&lt;&lt;&lt;&lt;&lt;</span><br></pre></td></tr></table></figure><p>Why? Because compiler is not that aggressive. RVO only applies for one return value, but ternary operator makes it an expression (to be more specific, a l-value). So even if they are semantically equivalent, compiler will take the conservative choice to use copy instead of move.</p><h2 id="Parameter-passing"><a href="#Parameter-passing" class="headerlink" title="Parameter passing"></a>Parameter passing</h2><p>Then, let‚Äôs see how C++ prepare the function parameters. To better understand this, you may need a quick look at the stack frame in C&#x2F;C++.</p><p><img src="/posts/C-Object-Lifecycle/Stackframe.svg" alt="Stackframe"></p><p>The arguments are placed on top of caller‚Äôs stack, so that callee can find it without knowing caller‚Äôs stack layout. And all that that implies, when passing arguments, we are initializing them in the <em>out going args</em> segment. So the arguments are actually in caller‚Äôs scope.</p><h3 id="Pass-by-value"><a href="#Pass-by-value" class="headerlink" title="Pass by value"></a>Pass by value</h3><p>To see it in action, let‚Äôs define a simple function with a value parameter and test it.</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="type">void</span> <span class="title">Pass</span><span class="params">(Object object)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="built_in">BEGIN_CALL</span>();</span><br><span class="line">    object.<span class="built_in">Print</span>();</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="built_in">BEGIN_SCOPE</span>(<span class="string">&quot;Pass by value&quot;</span>);</span><br><span class="line">    Object obj;</span><br><span class="line">    <span class="built_in">Pass</span>(obj);</span><br><span class="line">    <span class="built_in">Pass</span>(std::<span class="built_in">move</span>(obj));</span><br><span class="line">    <span class="built_in">Pass</span>(<span class="built_in">Object</span>(<span class="number">20</span>));</span><br><span class="line"><span class="built_in">END_SCOPE</span>();</span><br></pre></td></tr></table></figure><p>The output will be as follows.</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">========== Pass by value</span><br><span class="line">Default constructor       (0000006B984FF868)</span><br><span class="line">Copy constructor          (0000006B984FF870)</span><br><span class="line">&gt;&gt;&gt;&gt;&gt; Pass</span><br><span class="line">Data: 0</span><br><span class="line">&lt;&lt;&lt;&lt;&lt;</span><br><span class="line">Destructor                (0000006B984FF870)</span><br><span class="line">Move constructor          (0000006B984FF870)</span><br><span class="line">&gt;&gt;&gt;&gt;&gt; Pass</span><br><span class="line">Data: 0</span><br><span class="line">&lt;&lt;&lt;&lt;&lt;</span><br><span class="line">Destructor                (0000006B984FF870)</span><br><span class="line">Parameterized constructor (0000006B984FF870)</span><br><span class="line">&gt;&gt;&gt;&gt;&gt; Pass</span><br><span class="line">Data: 20</span><br><span class="line">&lt;&lt;&lt;&lt;&lt;</span><br><span class="line">Destructor                (0000006B984FF870)</span><br><span class="line">Destructor (moved)        (0000006B984FF868)</span><br><span class="line">----------</span><br></pre></td></tr></table></figure><p>First <code>Object obj;</code> will call default constructor to initialize the object in <em>local variable</em> segment. When calling <code>Pass(obj)</code>, it will first copy the object to the <em>out going args</em> segment which invokes copy constructor. Similarly, we can use <code>std::move</code> to invoke move constructor instead. And finally, we can pass a temporary object, which will construct the argument on site, with no extra copy or move.</p><div class="note success flat"><p>Are we getting it? It is the same as what we talked about the object initialization in <a href="#Object-creation">Object creation</a>.</p></div><p>So we can conclude that, pass by value may not be a good choice if we pass large objects often, and that‚Äôs why modern IDE suggests you use const reference instead.</p><h3 id="Pass-by-const-reference"><a href="#Pass-by-const-reference" class="headerlink" title="Pass by (const) reference"></a>Pass by (const) reference</h3><p>As we know, reference is a grammar sugar for pointers. Passing a reference is actually passing a pointer, so there is literally no overhead. Which is why we like it.</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="type">void</span> <span class="title">PassCopy</span><span class="params">(<span class="type">const</span> Object&amp; object)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="built_in">BEGIN_CALL</span>();</span><br><span class="line">    object.<span class="built_in">Print</span>();</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="built_in">BEGIN_SCOPE</span>(<span class="string">&quot;Pass Copy&quot;</span>);</span><br><span class="line">    Object obj;</span><br><span class="line">    <span class="built_in">PassCopy</span>(obj);</span><br><span class="line">    <span class="built_in">PassCopy</span>(<span class="built_in">Object</span>(<span class="number">20</span>));</span><br><span class="line"><span class="built_in">END_SCOPE</span>();</span><br></pre></td></tr></table></figure><p>The output is as follows.</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">========== Pass Copy</span><br><span class="line">Default constructor       (0000009D4A8FF878)</span><br><span class="line">&gt;&gt;&gt;&gt;&gt; PassCopy</span><br><span class="line">Data: 0</span><br><span class="line">&lt;&lt;&lt;&lt;&lt;</span><br><span class="line">Parameterized constructor (0000009D4A8FF874)</span><br><span class="line">&gt;&gt;&gt;&gt;&gt; PassCopy</span><br><span class="line">Data: 20</span><br><span class="line">&lt;&lt;&lt;&lt;&lt;</span><br><span class="line">Destructor                (0000009D4A8FF874)</span><br><span class="line">Destructor                (0000009D4A8FF878)</span><br><span class="line">----------</span><br></pre></td></tr></table></figure><p>We can see that, when using reference, no extra copy or move is needed, only the reference is passed. Which is why we prefer to use reference for large objects. In order not to accidentally modify the argument, we can add <code>const</code> to it.</p><div class="note warning flat"><p>Not that, simply using reference cannot accept constant parameter or temporary value. But const reference can bind everything.</p></div><h3 id="Pass-by-R-value-reference"><a href="#Pass-by-R-value-reference" class="headerlink" title="Pass by R-value reference"></a>Pass by R-value reference</h3><p>It is rare, but let‚Äôs not omit it. Passing by R-value requires that the argument is a R-value. <del>Duh</del></p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="type">void</span> <span class="title">PassMove</span><span class="params">(Object&amp;&amp; object)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="built_in">BEGIN_CALL</span>();</span><br><span class="line">    object.<span class="built_in">Print</span>();</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="built_in">BEGIN_SCOPE</span>(<span class="string">&quot;Pass Move&quot;</span>);</span><br><span class="line">    Object obj;</span><br><span class="line">    <span class="built_in">PassMove</span>(<span class="built_in">Object</span>(<span class="number">30</span>));</span><br><span class="line">    <span class="comment">// ConsumeMove(obj);    // compile error</span></span><br><span class="line">    <span class="built_in">PassMove</span>(std::<span class="built_in">move</span>(obj));</span><br><span class="line"><span class="built_in">END_SCOPE</span>();</span><br></pre></td></tr></table></figure><p>Notice that, R-value parameter does not accept L-value, so we must explicitly move our L-value to match the type.</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">========== Pass Move</span><br><span class="line">Default constructor       (0000009D4A8FF878)</span><br><span class="line">Parameterized constructor (0000009D4A8FF874)</span><br><span class="line">&gt;&gt;&gt;&gt;&gt; PassMove</span><br><span class="line">Data: 30</span><br><span class="line">&lt;&lt;&lt;&lt;&lt;</span><br><span class="line">Destructor                (0000009D4A8FF874)</span><br><span class="line">&gt;&gt;&gt;&gt;&gt; PassMove</span><br><span class="line">Data: 0</span><br><span class="line">&lt;&lt;&lt;&lt;&lt;</span><br><span class="line">Destructor                (0000009D4A8FF878)</span><br><span class="line">----------</span><br></pre></td></tr></table></figure><p>Since <code>std::move</code> works as a type cast, and not actual assignment happens, our <code>obj</code> is not really moved.</p><h2 id="Parameter-consuming"><a href="#Parameter-consuming" class="headerlink" title="Parameter consuming"></a>Parameter consuming</h2><p>Sometimes, especially in constructor, we need to copy the argument to initialize the certain members. In this case, which type of argument has lower overhead? Instead of calling <code>Print</code> only, we may have an initialization or assignment.</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="type">void</span> <span class="title">Consume</span><span class="params">(Object object)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="built_in">BEGIN_CALL</span>();</span><br><span class="line">    <span class="keyword">auto</span> o = object;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>The argument part is clear as we‚Äôve talked about just now, the only thing different is that we now have a new copy or move constructor. Of course passing by value is a terrible choice, so which one should we use? L-value reference or R-value reference?</p><p>But we cannot use R-value reference as it cannot bind L-value, so does it mean that L-value reference is our only choice? The answer is no. If you use <a target="_blank" rel="noopener" href="https://www.jetbrains.com/resharper/">ReSharper</a>, you might have seen such a suggestion.</p><p><img src="/posts/C-Object-Lifecycle/image-20241001160546356.png" alt="image-20241001160546356"></p><p>This problem can be demonstrated by the following function. Pass by reference, by value then move it.</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="type">void</span> <span class="title">ConsumeCopy</span><span class="params">(<span class="type">const</span> Object&amp; object)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="built_in">BEGIN_CALL</span>();</span><br><span class="line">    <span class="keyword">auto</span> o = object;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">ConsumeValueMove</span><span class="params">(Object object)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="built_in">BEGIN_CALL</span>();</span><br><span class="line">    <span class="keyword">auto</span> o = std::<span class="built_in">move</span>(object);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>To tell which one is better, we can have a little test. There are but two types of arguments, L-value and R-value. So we call each once to see the overhead.</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">BEGIN_SCOPE</span>(<span class="string">&quot;Pass by Reference&quot;</span>);</span><br><span class="line">    Object obj;</span><br><span class="line">    <span class="built_in">ConsumeCopy</span>(obj);</span><br><span class="line">    <span class="built_in">ConsumeCopy</span>(<span class="built_in">Object</span>(<span class="number">66</span>));</span><br><span class="line"><span class="built_in">END_SCOPE</span>();</span><br><span class="line"></span><br><span class="line"><span class="built_in">BEGIN_SCOPE</span>(<span class="string">&quot;Modernize Pass by Value&quot;</span>);</span><br><span class="line">    Object obj;</span><br><span class="line">    <span class="built_in">ConsumeValueMove</span>(obj);</span><br><span class="line">    <span class="built_in">ConsumeValueMove</span>(<span class="built_in">Object</span>(<span class="number">99</span>));</span><br><span class="line"><span class="built_in">END_SCOPE</span>();</span><br></pre></td></tr></table></figure><p>The result is not that surprising, pass by reference has fewer output, thus seems to be a better choice.</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line">========== Reference</span><br><span class="line">Default constructor       (000000E46D4FF788)</span><br><span class="line">&gt;&gt;&gt;&gt;&gt; ConsumeCopy</span><br><span class="line">Copy constructor          (000000E46D4FF790)</span><br><span class="line">Destructor                (000000E46D4FF790)</span><br><span class="line">&lt;&lt;&lt;&lt;&lt;</span><br><span class="line">Parameterized constructor (000000E46D4FF784)</span><br><span class="line">&gt;&gt;&gt;&gt;&gt; ConsumeCopy</span><br><span class="line">Copy constructor          (000000E46D4FF744)</span><br><span class="line">Destructor                (000000E46D4FF744)</span><br><span class="line">&lt;&lt;&lt;&lt;&lt;</span><br><span class="line">Destructor                (000000E46D4FF784)</span><br><span class="line">Destructor                (000000E46D4FF788)</span><br><span class="line">----------</span><br><span class="line"></span><br><span class="line">========== Modernize Pass by Value</span><br><span class="line">Default constructor       (000000E46D4FF784)</span><br><span class="line">Copy constructor          (000000E46D4FF790)</span><br><span class="line">&gt;&gt;&gt;&gt;&gt; ConsumeValueMove</span><br><span class="line">Move constructor          (000000E46D4FF738)</span><br><span class="line">Destructor                (000000E46D4FF738)</span><br><span class="line">&lt;&lt;&lt;&lt;&lt;</span><br><span class="line">Destructor (moved)        (000000E46D4FF790)</span><br><span class="line">Parameterized constructor (000000E46D4FF790)</span><br><span class="line">&gt;&gt;&gt;&gt;&gt; ConsumeValueMove</span><br><span class="line">Move constructor          (000000E46D4FF738)</span><br><span class="line">Destructor                (000000E46D4FF738)</span><br><span class="line">&lt;&lt;&lt;&lt;&lt;</span><br><span class="line">Destructor (moved)        (000000E46D4FF790)</span><br><span class="line">Destructor                (000000E46D4FF784)</span><br><span class="line">----------</span><br></pre></td></tr></table></figure><p>It may be a little long, so let‚Äôs summarize it, except <code>Object obj;</code>, we have the following statistics. Since a moved object‚Äôs destructor will also do fewer recycling, I count it individually.</p><table><thead><tr><th align="center"></th><th align="center">Pass by reference</th><th align="center">Pass by value then move</th><th align="center">Difference</th></tr></thead><tbody><tr><td align="center">(Parameterized) Constructor</td><td align="center">1</td><td align="center">1</td><td align="center">0</td></tr><tr><td align="center">Copy Constructor</td><td align="center">2</td><td align="center">1</td><td align="center">-1</td></tr><tr><td align="center">Move Constructor</td><td align="center">0</td><td align="center">2</td><td align="center">+2</td></tr><tr><td align="center">Destructor</td><td align="center">3</td><td align="center">2</td><td align="center">-1</td></tr><tr><td align="center">Destructor (moved)</td><td align="center">0</td><td align="center">2</td><td align="center">+2</td></tr></tbody></table><p>If both types of the arguments are passed with a roughly equal possibility, the overhead is related to the efficiency of copy and move. If the cost of copy and move are the same, then apparently pass by reference is better. You may choose the other only if move is much more efficient than copy.</p><p>However, if the argument is always (or most of the time) a temporary value, you may need to reconsider your choice. For example, if you use a string as the name of an object, then this string will most likely come from a temporary value.</p><table><thead><tr><th align="center"></th><th align="center">Pass by reference</th><th align="center">Pass by value then move</th><th align="center">Difference</th></tr></thead><tbody><tr><td align="center">(Parameterized) Constructor</td><td align="center">1</td><td align="center">1</td><td align="center">0</td></tr><tr><td align="center">Copy Constructor</td><td align="center">1</td><td align="center">0</td><td align="center">-1</td></tr><tr><td align="center">Move Constructor</td><td align="center">0</td><td align="center">1</td><td align="center">+1</td></tr><tr><td align="center">Destructor</td><td align="center">2</td><td align="center">1</td><td align="center">-1</td></tr><tr><td align="center">Destructor (moved)</td><td align="center">0</td><td align="center">1</td><td align="center">+1</td></tr></tbody></table><p>In this case, pass by value then move it can be a better choice.</p><h2 id="Objects-in-Array"><a href="#Objects-in-Array" class="headerlink" title="Objects in Array"></a>Objects in Array</h2><p>There is one thing we missed, that is array. What about the objects in array? For this, we can also write a simple test.</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">BEGIN_SCOPE</span>(<span class="string">&quot;Array&quot;</span>);</span><br><span class="line">    Object obj[<span class="number">2</span>] &#123; <span class="number">1</span> &#125;;</span><br><span class="line">    Object* pObj = <span class="keyword">new</span> Object[<span class="number">2</span>] &#123; <span class="number">1</span> &#125;;</span><br><span class="line">    obj[<span class="number">1</span>] = <span class="built_in">Object</span>(<span class="number">33</span>);</span><br><span class="line">    <span class="keyword">delete</span>[] pObj;  <span class="comment">// remember this</span></span><br><span class="line">    pObj = <span class="built_in">static_cast</span>&lt;Object*&gt;(<span class="built_in">malloc</span>(<span class="built_in">sizeof</span>(Object) * <span class="number">2</span>));</span><br><span class="line">    pObj[<span class="number">0</span>].<span class="built_in">Print</span>();</span><br><span class="line">    <span class="built_in">free</span>(pObj);     <span class="comment">// don&#x27;t forget this also</span></span><br><span class="line"><span class="built_in">END_SCOPE</span>();</span><br></pre></td></tr></table></figure><p>By running it, we‚Äôll have the following output.</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">========== Array</span><br><span class="line">Parameterized constructor (000000C30472FEB8)</span><br><span class="line">Default constructor       (000000C30472FEBC)</span><br><span class="line">Parameterized constructor (00000299414B7028)</span><br><span class="line">Default constructor       (00000299414B702C)</span><br><span class="line">Parameterized constructor (000000C30472FEA0)</span><br><span class="line">Move assignment operator  (000000C30472FEBC)</span><br><span class="line">Destructor (moved)        (000000C30472FEA0)</span><br><span class="line">Destructor                (00000299414B702C)</span><br><span class="line">Destructor                (00000299414B7028)</span><br><span class="line">Data: 997392451</span><br><span class="line">Destructor                (000000C30472FEBC)</span><br><span class="line">Destructor                (000000C30472FEB8)</span><br><span class="line">----------</span><br></pre></td></tr></table></figure><p>We can see that, array will call the default constructor on each element, so will the <code>new</code> operator. Correspondingly, their destructor will also be called. So it introduces a problem that you have to provide a default constructor or explicitly initialize every element on creation. Of course there is a work around, that is using <code>malloc</code> and <code>free</code>. But in this case you will also lose the destructor.</p><hr><h1 id="Epilogue"><a href="#Epilogue" class="headerlink" title="Epilogue"></a>Epilogue</h1><p>I have wished to take a deep look at how C++ handle objects for long, and now this is the day, <del>when I send all my doubts and daemons on their way, ‚Ä¶</del></p><p>Anyway, it helps me to understand the object lifecycle in C++, and hope this post can also help you. ·ìö·òè·ó¢</p></article><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta"><i class="fas fa-circle-user fa-fw"></i>Author: </span><span class="post-copyright-info"><a target="_blank" rel="noopener" href="https://www.tonys-studio.top">Tony Lewis</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta"><i class="fas fa-square-arrow-up-right fa-fw"></i>Link: </span><span class="post-copyright-info"><a href="https://blog.tonys-studio.top/posts/C-Object-Lifecycle/">https://blog.tonys-studio.top/posts/C-Object-Lifecycle/</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta"><i class="fas fa-circle-exclamation fa-fw"></i>Copyright Notice: </span><span class="post-copyright-info">All articles on this blog are licensed under <a target="_blank" rel="noopener" href="https://creativecommons.org/licenses/by-nc-sa/4.0/">CC BY-NC-SA 4.0</a> unless otherwise stated.</span></div></div><div class="tag_share"><div class="post-meta__tag-list"><a class="post-meta__tags" href="/tags/C-C/">C/C++</a></div><div class="post-share"><div class="addtoany"><div class="a2a_kit a2a_kit_size_32 a2a_default_style"><a class="a2a_button_wechat"></a><a class="a2a_button_qzone"></a><a class="a2a_button_sina_weibo"></a><a class="a2a_button_telegram"></a><a class="a2a_button_whatsapp"></a><a class="a2a_button_facebook"></a><a class="a2a_button_twitter"></a><a class="a2a_button_email"></a><a class="a2a_button_copy_link"></a><a class="a2a_dd" target="_blank" rel="noopener" href="https://www.addtoany.com/share"></a></div></div><script async src="https://static.addtoany.com/menu/page.js"></script></div></div><nav class="pagination-post" id="pagination"><a class="pagination-related" href="/posts/Document-Scan-Effect-in-Photoshop/" title="Document Scan Effect in Photoshop"><img class="cover" src="https://tonys-studio-1308383348.cos.ap-beijing.myqcloud.com/blog/static/posts/Document-Scan-Effect-in-Photoshop.png" onerror='onerror=null,src="https://tonys-studio-1308383348.cos.ap-beijing.myqcloud.com/blog/static/404.png"' alt="cover of previous post"><div class="info"><div class="info-1"><div class="info-item-1">Previous</div><div class="info-item-2">Document Scan Effect in Photoshop</div></div><div class="info-2"><div class="info-item-1">Creating document scan effect in Photoshop</div></div></div></a><a class="pagination-related" href="/posts/Git-Cheat-Sheet/" title="Git Cheat Sheet"><img class="cover" src="https://tonys-studio-1308383348.cos.ap-beijing.myqcloud.com/blog/static/cover/mando/22/11.jpeg" onerror='onerror=null,src="https://tonys-studio-1308383348.cos.ap-beijing.myqcloud.com/blog/static/404.png"' alt="cover of next post"><div class="info text-right"><div class="info-1"><div class="info-item-1">Next</div><div class="info-item-2">Git Cheat Sheet</div></div><div class="info-2"><div class="info-item-1">A collection of useful Git commands that is helpful but in rare cases</div></div></div></a></nav><div class="relatedPosts"><div class="headline"><i class="fas fa-thumbs-up fa-fw"></i><span>Related Articles</span></div><div class="relatedPosts-list"><a class="pagination-related" href="/posts/Configure-VS-for-Non-MSVC-Projects/" title="Configure Visual Studio for Non-MSVC Projects"><img class="cover" src="https://tonys-studio-1308383348.cos.ap-beijing.myqcloud.com/blog/static/cover/mando/15/03.jpeg" alt="cover"><div class="info text-center"><div class="info-1"><div class="info-item-1"><i class="far fa-calendar-alt fa-fw"></i> Apr. 27th, 2023 - 09:13:37</div><div class="info-item-2">Configure Visual Studio for Non-MSVC Projects</div></div><div class="info-2"><div class="info-item-1">Configure VS IntelliSense for GCC</div></div></div></a><a class="pagination-related" href="/posts/Dungeon/" title="Dungeon"><img class="cover" src="https://tonys-studio-1308383348.cos.ap-beijing.myqcloud.com/blog/static/posts/Dungeon.png" alt="cover"><div class="info text-center"><div class="info-1"><div class="info-item-1"><i class="far fa-calendar-alt fa-fw"></i> Jan. 4th, 2023 - 21:45:04</div><div class="info-item-2">Dungeon</div></div><div class="info-2"><div class="info-item-1">A rogue-like game developed with EasyX and FMOD in C++.</div></div></div></a><a class="pagination-related" href="/posts/Game-Engine-0-to-1-00-Nothing-s-Here/" title="Game Engine 0 to 1 (00): Nothing&#39;s Here"><img class="cover" src="https://tonys-studio-1308383348.cos.ap-beijing.myqcloud.com/blog/static/cover/mando/11/09.jpeg" alt="cover"><div class="info text-center"><div class="info-1"><div class="info-item-1"><i class="far fa-calendar-alt fa-fw"></i> May. 27th, 2025 - 19:05:29</div><div class="info-item-2">Game Engine 0 to 1 (00): Nothing&#39;s Here</div></div><div class="info-2"><div class="info-item-1">Game Engine Series 00: Prologue</div></div></div></a><a class="pagination-related" href="/posts/Game-Engine-0-to-1-01-It-Starts-Now/" title="Game Engine 0 to 1 (01): It Starts Now"><img class="cover" src="https://tonys-studio-1308383348.cos.ap-beijing.myqcloud.com/blog/static/cover/boba/06/08.jpeg" alt="cover"><div class="info text-center"><div class="info-1"><div class="info-item-1"><i class="far fa-calendar-alt fa-fw"></i> Jun. 1st, 2025 - 14:45:32</div><div class="info-item-2">Game Engine 0 to 1 (01): It Starts Now</div></div><div class="info-2"><div class="info-item-1">Game Engine Series 01: Project setup</div></div></div></a><a class="pagination-related" href="/posts/Game-Engine-0-to-1-02-Something-on-the-Screen/" title="Game Engine 0 to 1 (02): Something on the Screen"><img class="cover" src="https://tonys-studio-1308383348.cos.ap-beijing.myqcloud.com/blog/static/cover/ahsoka/00.jpeg" alt="cover"><div class="info text-center"><div class="info-1"><div class="info-item-1"><i class="far fa-calendar-alt fa-fw"></i> Jul. 4th, 2025 - 20:07:57</div><div class="info-item-2">Game Engine 0 to 1 (02): Something on the Screen</div></div><div class="info-2"><div class="info-item-1">Game Engine Series 02: Graphics Device</div></div></div></a><a class="pagination-related" href="/posts/Inter-Process-Communication/" title="Inter-Process Communication"><img class="cover" src="https://tonys-studio-1308383348.cos.ap-beijing.myqcloud.com/blog/static/cover/mando/06/03.jpeg" alt="cover"><div class="info text-center"><div class="info-1"><div class="info-item-1"><i class="far fa-calendar-alt fa-fw"></i> Jan. 4th, 2023 - 17:56:03</div><div class="info-item-2">Inter-Process Communication</div></div><div class="info-2"><div class="info-item-1">Chapter Seven - Inter Process Communication</div></div></div></a></div></div><hr class="custom-hr"><div id="post-comment"><div class="comment-head"><div class="comment-headline"><i class="fas fa-comments fa-fw"></i><span> Comments</span></div></div><div class="comment-wrap"><div><div id="waline-wrap"></div></div></div></div></div><div class="aside-content" id="aside-content"><div class="card-widget card-info text-center"><div class="avatar-img"><img src="https://tonys-studio-1308383348.cos.ap-beijing.myqcloud.com/blog/static/avatar.png" onerror='this.onerror=null,this.src="https://tonys-studio-1308383348.cos.ap-beijing.myqcloud.com/blog/static/missing.gif"' alt="avatar"></div><div class="author-info-name">Tony Lewis</div><div class="author-info-description">Do or do not. There is no try.</div><div class="site-data"><a href="/archives/"><div class="headline">Articles</div><div class="length-num">95</div></a><a href="/tags/"><div class="headline">Tags</div><div class="length-num">86</div></a><a href="/categories/"><div class="headline">Categories</div><div class="length-num">40</div></a></div><a id="card-info-btn" target="_blank" rel="noopener" href="https://github.com/Lord-Turmoil"><i class="fab fa-github"></i><span>Follow Me</span></a><div class="card-info-social-icons"><a class="social-icon" href="https://github.com/Lord-Turmoil" target="_blank" title="Github"><i class="fa-brands fa-github"></i></a><a class="social-icon" href="mailto:swift-phantom@outlook.com" target="_blank" title="Email"><i class="fa-solid fa-envelope"></i></a><a class="social-icon" href="https://space.bilibili.com/2030942344" target="_blank" title="BiliBili"><i class="fa-brands fa-bilibili"></i></a></div></div><div class="card-widget card-announcement"><div class="item-headline"><i class="fas fa-bullhorn fa-shake"></i><span>Announcement</span></div><div class="announcement_content">Hello there!</div></div><div class="sticky_layout"><div class="card-widget" id="card-toc"><div class="item-headline"><i class="fas fa-stream"></i><span>Contents</span><span class="toc-percentage"></span></div><div class="toc-content"><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#Prologue"><span class="toc-text">Prologue</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#Instrument-Utilities"><span class="toc-text">Instrument Utilities</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#Subject-class"><span class="toc-text">Subject class</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Scope-indicator"><span class="toc-text">Scope indicator</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#Lifecycle-Breakdown"><span class="toc-text">Lifecycle Breakdown</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#Object-creation"><span class="toc-text">Object creation</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Return-Value-Optimization"><span class="toc-text">Return Value Optimization</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Parameter-passing"><span class="toc-text">Parameter passing</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Pass-by-value"><span class="toc-text">Pass by value</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Pass-by-const-reference"><span class="toc-text">Pass by (const) reference</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Pass-by-R-value-reference"><span class="toc-text">Pass by R-value reference</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Parameter-consuming"><span class="toc-text">Parameter consuming</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Objects-in-Array"><span class="toc-text">Objects in Array</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#Epilogue"><span class="toc-text">Epilogue</span></a></li></ol></div></div><div class="card-widget card-recent-post"><div class="item-headline"><i class="fas fa-history"></i><span>Recent Posts</span></div><div class="aside-list"><div class="aside-list-item"><a class="thumbnail" href="/posts/A-Fancy-And-Practical-Zsh-Configuration/" title="A Fancy and Practical Zsh Configuration"><img src="https://tonys-studio-1308383348.cos.ap-beijing.myqcloud.com/blog/static/cover/mando/21/07.jpeg" onerror='this.onerror=null,this.src="https://tonys-studio-1308383348.cos.ap-beijing.myqcloud.com/blog/static/404.png"' alt="A Fancy and Practical Zsh Configuration"></a><div class="content"><a class="title" href="/posts/A-Fancy-And-Practical-Zsh-Configuration/" title="A Fancy and Practical Zsh Configuration">A Fancy and Practical Zsh Configuration</a><time datetime="2025-09-26T14:15:54.000Z" title="Created Sep. 26th, 2025 - 22:15:54 22:15:54">Sep. 26th, 2025 - 22:15:54</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/posts/Lambda-Calculus-A-Preliminary-View/" title="Lambda Calculus: A Preliminary View"><img src="https://tonys-studio-1308383348.cos.ap-beijing.myqcloud.com/blog/static/cover/boba/04/02.jpeg" onerror='this.onerror=null,this.src="https://tonys-studio-1308383348.cos.ap-beijing.myqcloud.com/blog/static/404.png"' alt="Lambda Calculus: A Preliminary View"></a><div class="content"><a class="title" href="/posts/Lambda-Calculus-A-Preliminary-View/" title="Lambda Calculus: A Preliminary View">Lambda Calculus: A Preliminary View</a><time datetime="2025-09-16T08:25:34.000Z" title="Created Sep. 16th, 2025 - 16:25:34 16:25:34">Sep. 16th, 2025 - 16:25:34</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/posts/Music-Notation-with-Avid-Sibelius/" title="Music Notation With Avid Sibelius"><img src="https://tonys-studio-1308383348.cos.ap-beijing.myqcloud.com/blog/static/posts/Music-Notation-with-Avid-Sibelius.jpg" onerror='this.onerror=null,this.src="https://tonys-studio-1308383348.cos.ap-beijing.myqcloud.com/blog/static/404.png"' alt="Music Notation With Avid Sibelius"></a><div class="content"><a class="title" href="/posts/Music-Notation-with-Avid-Sibelius/" title="Music Notation With Avid Sibelius">Music Notation With Avid Sibelius</a><time datetime="2025-09-03T04:34:54.000Z" title="Created Sep. 3rd, 2025 - 12:34:54 12:34:54">Sep. 3rd, 2025 - 12:34:54</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/posts/Getting-Started-with-Coq/" title="Getting Started With Coq"><img src="https://tonys-studio-1308383348.cos.ap-beijing.myqcloud.com/blog/static/cover/mando/09/08.jpeg" onerror='this.onerror=null,this.src="https://tonys-studio-1308383348.cos.ap-beijing.myqcloud.com/blog/static/404.png"' alt="Getting Started With Coq"></a><div class="content"><a class="title" href="/posts/Getting-Started-with-Coq/" title="Getting Started With Coq">Getting Started With Coq</a><time datetime="2025-08-08T04:30:12.000Z" title="Created Aug. 8th, 2025 - 12:30:12 12:30:12">Aug. 8th, 2025 - 12:30:12</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/posts/Game-Engine-0-to-1-02-Something-on-the-Screen/" title="Game Engine 0 to 1 (02): Something on the Screen"><img src="https://tonys-studio-1308383348.cos.ap-beijing.myqcloud.com/blog/static/cover/ahsoka/00.jpeg" onerror='this.onerror=null,this.src="https://tonys-studio-1308383348.cos.ap-beijing.myqcloud.com/blog/static/404.png"' alt="Game Engine 0 to 1 (02): Something on the Screen"></a><div class="content"><a class="title" href="/posts/Game-Engine-0-to-1-02-Something-on-the-Screen/" title="Game Engine 0 to 1 (02): Something on the Screen">Game Engine 0 to 1 (02): Something on the Screen</a><time datetime="2025-07-04T12:07:57.000Z" title="Created Jul. 4th, 2025 - 20:07:57 20:07:57">Jul. 4th, 2025 - 20:07:57</time></div></div></div></div></div></div></main><footer id="footer" style="background-image:url(https://tonys-studio-1308383348.cos.ap-beijing.myqcloud.com/blog/static/cover/mando/24/04.jpeg)"><div class="footer-other"><div class="footer-copyright"><span class="copyright">&copy;&nbsp;2025 By Tony Lewis</span></div><div class="footer_custom_text">No bird soars too high if he soars on his own wings</div></div></footer></div><div id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="Reading Mode"><i class="fas fa-book-open"></i></button><button id="darkmode" type="button" title="Toggle Between Light and Dark Mode"><i class="fas fa-adjust"></i></button><button id="hide-aside-btn" type="button" title="Toggle Between Single-column and Double-column"><i class="fas fa-arrows-alt-h"></i></button></div><div id="rightside-config-show"><button id="rightside-config" type="button" title="Settings"><i class="fas fa-cog"></i></button><button class="close" id="mobile-toc-button" type="button" title="Table of Contents"><i class="fas fa-list-ul"></i></button><a id="to_comment" href="#post-comment" title="Scroll to Comments"><i class="fas fa-comments"></i></a><button id="go-up" type="button" title="Back to Top"><span class="scroll-percent"></span><i class="fas fa-arrow-up"></i></button></div></div><div><script src="/js/utils.js"></script><script src="/js/main.js"></script><script src="https://cdn.jsdelivr.net/npm/@fancyapps/ui/dist/fancybox/fancybox.umd.min.js"></script><script src="https://cdn.jsdelivr.net/npm/instant.page/instantpage.min.js" type="module"></script><script src="https://cdn.jsdelivr.net/npm/node-snackbar/dist/snackbar.min.js"></script><div class="js-pjax"><script>(()=>{const e=()=>{const e=document.querySelectorAll("#article-container .mermaid-wrap");if(0===e.length)return;const t=()=>(e=>{window.loadMermaid=!0;const t="dark"===document.documentElement.getAttribute("data-theme")?"dark":"forest";e.forEach((e,n)=>{const d=e.firstElementChild,r="mermaid-"+n,a=`%%{init:{ 'theme':'${t}'}}%%\n`+d.textContent,i=mermaid.render(r,a),m=e=>{d.insertAdjacentHTML("afterend",e)};"string"==typeof i?m(i):i.then(({svg:e})=>m(e))})})(e);btf.addGlobalFn("themeChange",t,"mermaid"),window.loadMermaid?t():btf.getScript("https://cdn.jsdelivr.net/npm/mermaid/dist/mermaid.min.js").then(t)};btf.addGlobalFn("encrypt",e,"mermaid"),window.pjax?e():document.addEventListener("DOMContentLoaded",e)})()</script><script>(()=>{let n=window.walineFn||null;const e="shuoshuo"===GLOBAL_CONFIG_SITE.pageType,t=(n,t=document,i=window.location.pathname)=>{const o=n({el:t.querySelector("#waline-wrap"),serverURL:"https://comment.tonys-studio.top",pageview:!0,dark:'html[data-theme="dark"]',comment:!0,path:i});e&&(window.shuoshuoComment.destroyWaline=()=>{o.destroy(),t.children.length&&(t.innerHTML="",t.classList.add("no-comment"))})},i=(e,i)=>{n?t(n,e,i):btf.getCSS("https://cdn.jsdelivr.net/npm/@waline/client@2/dist/waline.min.css").then(()=>import("https://cdn.jsdelivr.net/npm/@waline/client@2/dist/waline.min.js")).then(({init:o})=>{n=o||Waline.init,t(n,e,i),window.walineFn=n})};e?window.shuoshuoComment={loadComment:i}:setTimeout(i,0)})()</script></div><script src="/static/custom.js"></script><script src="https://cdn.jsdelivr.net/npm/butterfly-extsrc/dist/activate-power-mode.min.js"></script><script>POWERMODE.colorful=!0,POWERMODE.shake=!0,POWERMODE.mobile=!1,document.body.addEventListener("input",POWERMODE)</script><div id="local-search"><div class="search-dialog"><nav class="search-nav"><span class="search-dialog-title">Search</span><i class="fas fa-spinner fa-pulse" id="loading-status" hidden></i><button class="search-close-button"><i class="fas fa-times"></i></button></nav><div class="text-center" id="loading-database"><i class="fas fa-spinner fa-pulse"></i><span> Loading Database</span></div><div class="local-search-input"><input placeholder="Looking for something?üîç" type="text"></div><hr><div id="local-search-results"></div><div class="ais-Pagination" id="local-search-pagination" style="display:none"><ul class="ais-Pagination-list"></ul></div><div id="local-search-stats"></div></div><div id="search-mask"></div><script src="/js/search/local-search.js"></script></div></div><script data-pjax>function butterfly_footer_beautify_injector_config(){var e=document.getElementById("footer");console.log("Â∑≤ÊåÇËΩΩbutterfly_footer_beautify"),e.insertAdjacentHTML("beforeend",'<p id="ghbdages"><a class="github-badge" target="_blank" href="https://hexo.io/" style="margin-inline:5px" data-title="Framework Hexo" title=""><img src="https://img.shields.io/badge/Frame-Hexo%205.4.2-blue?style=flat-square&amp;logo=hexo" alt=""/></a><a class="github-badge" target="_blank" href="https://butterfly.js.org/" style="margin-inline:5px" data-title="Theme Butterfly" title=""><img src="https://img.shields.io/badge/Theme-Butterfly%205.4.3-6513df?style=flat-square&amp;logo=bitdefender" alt=""/></a><a class="github-badge" target="_blank" href="http://creativecommons.org/licenses/by-nc-sa/4.0/" style="margin-inline:5px" data-title="All articles in this blog are licensed under CC BY-NC-SA 4.0 unless stating additionally." title=""><img src="https://img.shields.io/badge/Copyright-BY--NC--SA%204.0-d42328?style=flat-square&amp;logo=Claris" alt=""/></a></p>')}for(var elist="null".split(","),cpage=location.pathname,epage="all",flag=0,i=0;i<elist.length;i++)cpage.includes(elist[i])&&flag++;("all"===epage&&0==flag||epage===cpage)&&butterfly_footer_beautify_injector_config()</script></body></html>